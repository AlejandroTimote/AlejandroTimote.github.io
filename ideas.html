<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ideas de Detalles</title>

<link rel="stylesheet" href="ideas.css">

</head>
<body>

<div class="container">
    <div id="mensajeExito" class="mensaje-exito">Idea agregada con Ã©xito ğŸ’–</div>

    <h1>Ideas de Detalles ğŸ’˜</h1>
    <div class="heart">ğŸğŸğŸ</div>

    <label>Â¿QuiÃ©n soy?</label>
    <select id="persona">
        <option value="Alejo">Alejo</option>
        <option value="Kate">Kate</option>
    </select>

    <label>Tipo de producto</label>
    <select id="tipo">
        <option value="Cosa">Cosa</option>
        <option value="Comida">Comida</option>
    </select>

    <label>Idea o producto</label>
    <input type="text" id="idea" placeholder="Ej: Flores, Chocolates, Pizza, Perfume...">

    <label>DescripciÃ³n</label>
    <textarea id="descripcion" placeholder="Detalles, colores, precios..."></textarea>

    <button onclick="agregarIdea()">Agregar Idea ğŸ</button>

    <table>
        <thead>
            <tr>
                <th>Persona</th>
                <th>Tipo</th>
                <th>Idea</th>
                <th>DescripciÃ³n</th>
            </tr>
        </thead>
        <tbody id="tablaIdeas"></tbody>
    </table>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyRVdXycJshJqWSwWBu972v-A-wl8lMsNfx4h4vqSoagpbJys63kMZZZAc2QdHnLI1v3Q/exec";

let ideas = [];

// ======================
// CARGAR DESDE GOOGLE SHEETS
// ======================
window.onload = function() {
    fetch(API_URL)
        .then(res => res.json())
        .then(data => {
            ideas = data;
            renderTabla();
        })
        .catch(err => console.error("Error cargando datos:", err));
};


// ======================
// AGREGAR IDEA AL GOOGLE SHEET
// ======================
function agregarIdea() {
    const persona = document.getElementById("persona").value;
    const tipo = document.getElementById("tipo").value;
    const idea = document.getElementById("idea").value.trim();
    const descripcion = document.getElementById("descripcion").value.trim();

    if (!idea) {
        alert("Debes escribir una idea!");
        return;
    }

    const nuevaIdea = { persona, tipo, idea, descripcion };

    fetch(API_URL, {
        method: "POST",
        body: JSON.stringify(nuevaIdea)
    })
    .then(() => {
        ideas.push(nuevaIdea);
        renderTabla();

        document.getElementById("idea").value = "";
        document.getElementById("descripcion").value = "";

        mostrarMensajeExito();
    })
    .catch(err => alert("Error guardando: " + err));
}


function mostrarMensajeExito() {
    const msg = document.getElementById("mensajeExito");
    msg.style.display = "block";

    setTimeout(() => {
        msg.style.display = "none";
    }, 8000);
}


// ======================
// RENDER TABLA
// ======================
function renderTabla() {
    const tabla = document.getElementById("tablaIdeas");
    tabla.innerHTML = "";

    ideas.forEach(i => {
        tabla.innerHTML += `
            <tr>
                <td>${i.persona}</td>
                <td>${i.tipo}</td>
                <td>${i.idea}</td>
                <td>${i.descripcion}</td>
            </tr>
        `;
    });
}
</script>

</body>
</html>
